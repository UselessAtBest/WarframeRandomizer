<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QTCC Creator Clash</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<link href='https://fonts.googleapis.com/css?family=Open Sans' rel='stylesheet'>
    <style>
        body {
            font-family: 'Open Sans';
            padding: 20px;
            background-color: #232428;
        }
        .grid-container {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 1000px;
            align-content: start;
            grid-auto-flow: dense;
            margin-top: 2000px;
        }
        button {
            padding: 15px;
            font-size: 16px;
            cursor: pointer;
        }
        #output-container {
         display: flex;               
         justify-content: center;    
         color: #BCBCBC;
}

    #output {
         display: inline-block;      
          font-size: 30px;           
           color: #BCBCBC;            
            font-weight: bold;       
         padding: 15px;           
         border: 4px groove #1E1F22;    
         background-color: #232428;  
          border-radius: 10px;        
          text-align: center;       
         max-width: 100%;           
         word-wrap: break-word;    
}
        #counter {
            font-size: 24px;
            font-weight: bold;
        }
                
        #message {
            display: flex;               
            color: red;
            font-weight: bold;
            display: block;
            margin: 10px auto;
            font-size: 20px;
        }


        #modal, #previous-rolls-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none; /* Hidden by default */
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        #modal-content, #previous-rolls-content {
            background-color: #BCBCBC;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            width: 400px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        #modal-header, #previous-rolls-header {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        #modal-paragraph {
            font-size: 18px;
            margin-bottom: 30px;
        }

        #counter-container {
            position: fixed;
            z-index: 9999;
            border: 2px solid #000000; 
           padding: 10px;          
         background-color: #1E1F22; 
         border-radius: 5px;    
         margin-bottom: 20px; 
         width: fit-content;
         color: #BCBCBC;
        }


            #title-container {
            font-size:45px;
            align-items: center;
            display:flex;
            border: 2px solid #000000; 
           padding: 10px;          
         background-color: #1E1F22; 
         border-radius: 5px;    
         margin-bottom: 20px; 
         margin-left: 200px;
         width: fit-content;
         color: #BCBCBC;
        }


        
        #close-modal-btn, #close-rolls-btn, #undo-btn {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            margin-top: 10px;
        }

        #close-modal-btn {
            background-color: red;
            color: #BCBCBC;
        }

        #close-modal-btn:hover {
            background-color: darkred;
        }

        #close-rolls-btn {
            background-color: rgba(255, 0, 0, 0.733); 
             color: white;
              border: none;
             padding: 10px 15px;
              border-radius: 5px;
             cursor: pointer;
        }

        #close-rolls-btn:hover {
             background-color: darkred; 
        }


        #undo-btn {
            background-color: blue;
            color: rgb(95, 91, 91);
        }

        #undo-btn:hover {
            background-color: darkblue;
        }

        #info-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none; /* Hidden by default */
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        #info-modal-content {
            background-color: #BCBCBC;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            width: 1600px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        #info-modal-header {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        #info-modal-paragraph {
            font-size: 18px;
            margin-bottom: 30px;
        }

        #close-info-modal-btn {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background-color: #4C1D77;
            color: #BCBCBC;
            border: none;
            border-radius: 5px;
        }

        #close-info-modal-btn:hover {
            background-color: #341451;
        }



        /* Group Styles */
        .group {
         display:inline-block ; 
         border: 4px solid #1F1F1F; 
         padding: 10px;
         margin: 10px; 
         border-radius: 5px; 
         vertical-align: top; 
         width: 410px;
        }
        
         
        
        .option-line {
        display:flex ; 
        flex-direction: row;
        justify-content: space-between;
         align-items: center; 
         margin-top: 5px;
         width: 100%;
         position: relative;
         color: #BCBCBC;
        }
        
        
        .group-header, .group-footer {
            font-weight: bold;
            font-size: 24px;
            text-align: center;
            padding-bottom: 12px;
            color: #CCCCCC;
        }

        .left-text {
            text-align: left;
            white-space: nowrap;
            margin-right: 10px;
            font-weight: bold;

}


        .center-wrapper{
            position: absolute;
            left: 35%;
            transform: translateX(0%);
            text-align: center;
        }


        .right-wrapper{
            position: absolute;
            right: 0%;
        }

        .center-text {
            white-space: nowrap;

}      



         input[type="checkbox"] {
          margin-left: 0%;
}

        .grayed-out {
            background-color: #353638;
            color: #353638;
            text-decoration: line-through;
        }

        .footer-line {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
            font-size: 40px;
        }

        .footer-line input {
            margin-left: 10px;
        }

        #previous-rolls-list {
            max-height: 300px;
            width: auto;
            overflow-y: auto;
            margin-top: 10px;
        }

        .roll-item {
            margin: 5px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .roll-item span {
            width: calc(100% - 100px); 
        }
    </style>
</head>
<body style="background-color: #313239;">
   
    
    <div id="counter-container"> 
        <div id="counter">Points: 0</div>
    </div>


    <div id="title-container"> 
        <div style="padding-right: 40px; padding-left:20px;">
            <div id="title">QTCC Creator Clash</div>
        </div>
        <img src="https://content.invisioncic.com/Mwarframe/pages_media/ConqueraGlyph.png" alt="alternatetext"width="90" height="auto"> 
</div>

    <div style="display: flex; justify-content:right ; padding-left: 175px;">
        <button id="previous-rolls-btn" onclick="togglePreviousRolls()">Previous Rolls</button>
        <button onclick="toggleInfoModal()">Info / Rules</button> 
    </div>
    
        
    <div id="output-container">
        <div id="output">Roll a category to begin!</div>

    </div>
    
    <div id="message"></div>


    <div class="grid-container">

        <button onclick="getRandomLine('files/warframe/10-Warframe.txt')">
            <span class="button-main-text">Warframe</span>
            <span class="button-sub-text">(10 points)</span>
        </button>
        <button onclick="getRandomLine('files/warframe/3-WarframeModAura.txt')">
            <span class="button-main-text">Warframe Mod</span>
            <span class="button-mid-text">Aura</span>
            <span class="button-sub-text">(3 points)</span>
        </button>
        <button onclick="getRandomLine('files/warframe/5-WarframeModHighCost.txt')">
            <span class="button-main-text">Warframe Mod</span>
            <span class="button-mid-text">High Cost</span>
            <span class="button-sub-text">(5 points)</span>
        </button>
        <button onclick="getRandomLine('files/warframe/3-WarframeModLowCost.txt')">
            <span class="button-main-text">Warframe Mod</span>
            <span class="button-mid-text">Low Cost</span>
            <span class="button-sub-text">(3 points)</span>
        </button>
        <button onclick="getRandomLine('files/warframe/1-WarframeModUtility.txt')">
            <span class="button-main-text">Warframe Mod</span>
            <span class="button-mid-text">Utility</span>
            <span class="button-sub-text">(1 point)</span>
        </button>

        <button onclick="getRandomLine('files/primary/10-PrimaryWeaponHighCost.txt')">
            <span class="button-main-text">Primary Weapon</span>
            <span class="button-mid-text">High Cost</span>
            <span class="button-sub-text">(10 points)</span>
        </button>
        <button onclick="getRandomLine('files/primary/5-PrimaryWeaponLowCost.txt')">
            <span class="button-main-text">Primary Weapon Mod</span>
            <span class="button-mid-text">Low Cost</span>
            <span class="button-sub-text">(5 points)</span>
        </button>
        <button onclick="getRandomLine('files/primary/5-PrimaryWeaponModHighCost.txt')">
            <span class="button-main-text">Primary Weapon Mod</span>
            <span class="button-mid-text">High Cost</span>
            <span class="button-sub-text">(5 points)</span>
        </button>
        <button onclick="getRandomLine('files/primary/3-PrimaryWeaponModLowCost.txt')">
            <span class="button-main-text">Primary Weapon Mod</span>
            <span class="button-mid-text">Low Cost</span>
            <span class="button-sub-text">(3 points)</span>
        </button>
        <button onclick="getRandomLine('files/primary/1-PrimaryWeaponModUtility.txt')">
            <span class="button-main-text">Primary Weapon Mod</span>
            <span class="button-mid-text">Utility</span>
            <span class="button-sub-text">(1 points)</span>
        </button>

        <button onclick="getRandomLine('files/secondary/10-SecondaryWeaponHighCost.txt')">
            <span class="button-main-text">Secondary Weapon</span>
            <span class="button-mid-text">High Cost</span>
            <span class="button-sub-text">(10 points)</span>
        </button>
        <button onclick="getRandomLine('files/secondary/5-SecondaryWeaponLowCost.txt')">
            <span class="button-main-text">Secondary Weapon Mod</span>
            <span class="button-mid-text">Low Cost</span>
            <span class="button-sub-text">(5 points)</span>
        </button>
        <button onclick="getRandomLine('files/secondary/5-SecondaryWeaponModHighCost.txt')">
            <span class="button-main-text">Secondary Weapon Mod</span>
            <span class="button-mid-text">High Cost</span>
            <span class="button-sub-text">(5 points)</span>
        </button>
        <button onclick="getRandomLine('files/secondary/3-SecondaryWeaponModLowCost.txt')">
            <span class="button-main-text">Secondary Weapon Mod</span>
            <span class="button-mid-text">Low Cost</span>
            <span class="button-sub-text">(3 points)</span>
        </button>
        <button onclick="getRandomLine('files/secondary/1-SecondaryWeaponModUtility.txt')">
            <span class="button-main-text">Secondary Weapon Mod</span>
            <span class="button-mid-text">Utility</span>
            <span class="button-sub-text">(1 points)</span>
        </button>

        <button onclick="getRandomLine('files/melee/10-MeleeWeaponHighCost.txt')">
            <span class="button-main-text">Melee Weapon</span>
            <span class="button-mid-text">High Cost</span>
            <span class="button-sub-text">(10 points)</span>
        </button>
        <button onclick="getRandomLine('files/melee/5-MeleeWeaponLowCost.txt')">
            <span class="button-main-text">Melee Weapon Mod</span>
            <span class="button-mid-text">Low Cost</span>
            <span class="button-sub-text">(5 points)</span>
        </button>
        <button onclick="getRandomLine('files/melee/5-MeleeWeaponModHighCost.txt')">
            <span class="button-main-text">Melee Weapon Mod</span>
            <span class="button-mid-text">High Cost</span>
            <span class="button-sub-text">(5 points)</span>
        </button>
        <button onclick="getRandomLine('files/melee/3-MeleeWeaponModLowCost.txt')">
            <span class="button-main-text">Melee Weapon Mod</span>
            <span class="button-mid-text">Low Cost</span>
            <span class="button-sub-text">(3 points)</span>
        </button>
        <button onclick="getRandomLine('files/melee/1-MeleeWeaponModUtility.txt')">
            <span class="button-main-text">Melee Weapon Mod</span>
            <span class="button-mid-text">Utility</span>
            <span class="button-sub-text">(1 points)</span>
        </button>



    </div>

    <style>
        .grid-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr); 
            grid-template-rows: repeat(4, auto);
            grid-auto-flow: dense;    
            gap: 10px;                                
            justify-items: center;  
            margin: 0 auto;
            max-width: fit-content;
        }
    
        button {
            background-color: rgb(76, 29, 119);  /*----BUTTON COLOUR: ---- */
            color: #BCBCBC;                             
            border: 4px groove;
            border-color: #333;                             
            border-radius: 8px;                    
            padding: 10px;                             
            text-align: center;      
            cursor: pointer;          
            width: 300px;            
        }
    
        button:hover {
            background-color: #430E75; 
        }
    
        .button-main-text { 
            font-size: 24px;
            font-weight: bold;       
            display: block;            
        }

        .button-mid-text {
            font-size: 22px;
            text-decoration: underline;;        
            display: block;           
        }
    
        .button-sub-text {
            font-size: 20px;          
            display: block;            
        }
    </style>

    <!-- Groups of Options -->
    <div id="groups"></div>

    <script>
        const groupNames = ['earth','venus','mercury','mars','phobos','ceres','jupiter','europa','saturn','uranus','neptune','pluto','eris','sedna','void','lua','deimos','kuva_fortress','zariman',]; 
        const groupFiles = groupNames.map(name => `files/nodes/${name}.html`);
    
        Promise.all(groupFiles.map(file => fetch(file).then(response => {
            if (!response.ok) throw new Error('Network response was not ok');
            return response.text();
        })))
        .then(contents => {
            document.getElementById('groups').innerHTML = contents.join('');
        })
        .catch(error => console.error('Error loading external files:', error));
    </script>




<div id="previous-rolls-modal">
    <div id="previous-rolls-content">
        <div id="previous-rolls-header" style="display: flex; justify-content: space-between; align-items: center;">
            <button id="close-rolls-btn" onclick="closePreviousRolls()">
                <i class="fas fa-times"></i> Close
            </button>
            <span>Previous Rolls</span>
            <button id="undo-btn" onclick="undoLastRoll()">
                <i class="fas fa-undo"></i> Undo
            </button>
        </div>
        <div id="previous-rolls-list"></div>
    </div>
</div>

<div style="text-align: center; margin-top: 20px;">
    <button onclick="toggleInfoModal()">Info</button>
</div>

<div id="info-modal">
    <div id="info-modal-content">
        <div id="info-modal-header">Rules & Such</div>
        <div id="info-modal-paragraph">
            <!-- This content will be dynamically loaded -->
        </div>
        <button id="close-info-modal-btn" onclick="toggleInfoModal()">Close</button>
    </div>
</div>

<script>
    // Toggle the info modal visibility
    function toggleInfoModal() {
        const modal = document.getElementById('info-modal');
        const infoParagraph = document.getElementById('info-modal-paragraph');
        
        // Check if the modal is already open
        if (modal.style.display === 'flex') {
            modal.style.display = 'none';  // Close the modal
        } else {
            // Fetch the content from a separate file (e.g., info.txt)
            fetch('files/data.txt')
                .then(response => response.text())
                .then(data => {
                    infoParagraph.innerHTML = data; // Insert the fetched content into the modal
                    modal.style.display = 'flex';  // Open the modal
                })
                .catch(error => {
                    console.error('Error fetching the info file:', error);
                    infoParagraph.innerHTML = 'Error loading information.';
                    modal.style.display = 'flex';  // Open the modal even if there's an error
                });
        }
    }
       
       
       
       let counter = 0;
        let previousRolls = [];
        let lastRollPoints = 0;

        function getRandomLine(fileName) {
    const baseFileName = fileName.split('/').pop();
    const valueToSubtract = parseInt(baseFileName.split('-')[0]); 

    if (counter >= valueToSubtract) {
        fetch(fileName)
            .then(response => response.text())
            .then(data => {
                const lines = data.split('\n');
                const randomLine = lines[Math.floor(Math.random() * lines.length)];
                
                lastRollPoints = valueToSubtract; 
                counter -= valueToSubtract;
                previousRolls.push({ line: randomLine, cost: valueToSubtract });

                updateCounterDisplay();
                document.getElementById('output').textContent = randomLine;
                document.getElementById('message').textContent = ''; 
                
                updatePreviousRollsDisplay();
            })
            .catch(error => {
                console.error('Error fetching the file:', error);
                document.getElementById('output').textContent = 'Error fetching the file.';
            });
    } else {
        document.getElementById('message').textContent = 'Not enough points to roll this option!';
    }
}

        
function updateCounter(points, optionId) {
    const checkboxes = document.querySelectorAll(`#${optionId} input[type="checkbox"]`);
    
    // Calculate total points change based on the current state of the checkboxes
    let totalPointsChange = 0;

    // Count the checked checkboxes
    checkboxes.forEach(checkbox => {
        if (checkbox.checked) {
            totalPointsChange += points; // Add points for each checked checkbox 
        }
    });

    // Calculate the actual points to update
    const currentCheckboxCount = Array.from(checkboxes).filter(cb => cb.checked).length;
    const previousCheckboxCount = Number(localStorage.getItem(optionId)) || 0; // Store previous count in localStorage

    // Update points based on the difference between current and previous counts
    if (currentCheckboxCount > previousCheckboxCount) {
        counter += (currentCheckboxCount - previousCheckboxCount) * points; // Add points for new checkboxes
    } else {
        counter -= (previousCheckboxCount - currentCheckboxCount) * points; // Subtract points for unchecked checkboxes 
    }

    // Store the current count in localStorage for future reference
    localStorage.setItem(optionId, currentCheckboxCount);

    // Update the display
    updateCounterDisplay();
}

// Add event listeners to all checkboxes
document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
    checkbox.addEventListener('change', function() {
        const optionId = this.closest('.option-line').id; // Get the correct option line ID
        updateCounter(1, optionId); // Adjust points based on checkbox state
    });
});

function updateCounterDisplay() {
    document.getElementById('counter').textContent = `Points: ${counter}`;
}



        function updateCounterDisplay() {
            document.getElementById('counter').textContent = `Points: ${counter}`;
        }

        function togglePreviousRolls() {
            const modal = document.getElementById('previous-rolls-modal');
            modal.style.display = modal.style.display === 'flex' ? 'none' : 'flex';
        }

        function closePreviousRolls() {
            document.getElementById('previous-rolls-modal').style.display = 'none';
        }

        function undoLastRoll() {
            if (previousRolls.length > 0) {
                const lastRoll = previousRolls.pop(); 
                counter += lastRoll.cost; 
                updateCounterDisplay();
                updatePreviousRollsDisplay(); 
                document.getElementById('output').textContent = ''; 
                lastRollPoints = 0; 
            }
        }

        function updatePreviousRollsDisplay() {
            const rollsList = document.getElementById('previous-rolls-list');
            rollsList.innerHTML = ''; 

            previousRolls.forEach((roll, index) => {
                const rollItem = document.createElement('div');
                rollItem.className = 'roll-item';
                rollItem.innerHTML = `<span>${roll.line}</span><span>(Cost: ${roll.cost} points)</span>`;
                rollsList.appendChild(rollItem);
            });
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
        }




    </script>
</body>
</html>
